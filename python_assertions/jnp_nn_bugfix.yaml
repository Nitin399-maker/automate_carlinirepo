description: "Test if the model can identify and fix a bug in a given jax.numpy function."
providers:
  - {id: openrouter:anthropic/claude-3.7-sonnet, config: { max_tokens: 8192 }}

defaultTest:
  assert: []
  vars: {}

tests:
  - description: "Test if the model can identify and fix a bug in a given jax.numpy function."
    vars:
      prompt: |-
        Fix the bug in this jnp function. Write out the full correct version of the code.

        import jax
        import jax.numpy as jnp

        def init_mlp_params(input_size, hidden_size, output_size, key):
          k1, k2 = jax.random.split(key)
          # Initialize weights and biases for the first linear layer
          w1 = jax.random.normal(k1, (hidden_size, input_size)) * jnp.sqrt(2.0 / input_size)
          b1 = jnp.zeros(hidden_size)
          # Initialize weights and biases for the second linear layer
          w2 = jax.random.normal(k2, (output_size, hidden_size)) * jnp.sqrt(2.0 / hidden_size)
          b2 = jnp.zeros(output_size)
          return {
    assert:
      - type: python
        value: "file://jnp_nn_bugfix.py:get_assertion"

# Persist for the web viewer
writeLatestResults: true
# Ensure caching stays on
commandLineOptions:
  cache: true